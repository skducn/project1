-- todo 出生地-省市县

CREATE OR ALTER PROCEDURE p_birth_place
    @provinceKey nvarchar(150) OUTPUT,
    @province nvarchar(150) OUTPUT,
    @cityKey nvarchar(150) OUTPUT,
    @city nvarchar(150) OUTPUT,
    @countyKey nvarchar(150) OUTPUT,
    @county nvarchar(150) OUTPUT
AS
BEGIN
    SET NOCOUNT ON;

    -- 预生成字典临时表
    IF OBJECT_ID('tempdb..#tb_region') IS NOT NULL DROP TABLE #tb_region;
    CREATE TABLE #tb_region (
        ID INT IDENTITY(1,1),
        provinceKey NVARCHAR(6), -- 省级代码（前两位为省）
        cityKey NVARCHAR(6),     -- 市级代码（前四位为地级市）
        countyKey NVARCHAR(6),   -- 县级代码（六位全匹配）
        province NVARCHAR(50),
        city NVARCHAR(50),
        county NVARCHAR(50)
    );

    -- 插入模拟省市县数据（可根据实际需要扩展）
    INSERT INTO #tb_region (provinceKey, cityKey, countyKey, province, city, county) VALUES
    -- 北京市
    ('11', '1101', '110101', '北京', '北京', '东城'),
    ('11', '1101', '110102', '北京', '北京', '西城'),
    ('11', '1101', '110105', '北京', '北京', '朝阳'),
    -- 天津市
    ('12', '1201', '120101', '天津', '天津', '和平'),
    ('12', '1201', '120102', '天津', '天津', '河东'),
    ('12', '1201', '120113', '天津', '天津', '北辰'),
    -- 河北省
    ('13', '1301', '130102', '河北', '石家庄', '长安'),
    ('13', '1302', '130202', '河北', '唐山', '路南'),
    ('13', '1303', '130302', '河北', '秦皇岛', '海港'),
    -- 山西省
    ('14', '1401', '140105', '山西', '太原', '小店'),
    ('14', '1402', '140202', '山西', '大同', '城区'),
    ('14', '1403', '140302', '山西', '阳泉', '城区'),
    -- 内蒙古自治区
    ('15', '1501', '150102', '内蒙古', '呼和浩特', '回民'),
    ('15', '1502', '150202', '内蒙古', '包头', '东河'),
    ('15', '1503', '150302', '内蒙古', '乌海', '海勃湾'),
    -- 辽宁省
    ('21', '2101', '210102', '辽宁', '沈阳', '和平'),
    ('21', '2102', '210202', '辽宁', '大连', '中山'),
    ('21', '2103', '210302', '辽宁', '鞍山', '铁东'),
    -- 吉林省
    ('22', '2201', '220102', '吉林', '长春', '南关'),
    ('22', '2202', '220202', '吉林', '吉林', '昌邑'),
    ('22', '2203', '220302', '吉林', '四平', '铁东'),
    -- 黑龙江省
    ('23', '2301', '230102', '黑龙江', '哈尔滨', '道里'),
    ('23', '2302', '230202', '黑龙江', '齐齐哈尔', '龙沙'),
    ('23', '2303', '230302', '黑龙江', '鸡西', '鸡冠'),
    -- 上海市
    ('31', '3101', '310101', '上海', '上海', '黄浦'),
    ('31', '3101', '310104', '上海', '上海', '徐汇'),
    ('31', '3101', '310115', '上海', '上海', '浦东新'),
    -- 江苏省
    ('32', '3201', '320102', '江苏', '南京', '玄武'),
    ('32', '3202', '320205', '江苏', '无锡', '锡山'),
    ('32', '3203', '320302', '江苏', '徐州', '鼓楼'),
    -- 浙江省
    ('33', '3301', '330102', '浙江', '杭州', '上城'),
    ('33', '3302', '330203', '浙江', '宁波', '江北'),
    ('33', '3303', '330302', '浙江', '温州', '鹿城'),
    -- 安徽省
    ('34', '3401', '340102', '安徽', '合肥', '瑶海'),
    ('34', '3402', '340202', '安徽', '芜湖', '镜湖'),
    ('34', '3403', '340302', '安徽', '蚌埠', '龙子湖'),
    -- 福建省
    ('35', '3501', '350102', '福建', '福州', '鼓楼'),
    ('35', '3502', '350203', '福建', '厦门', '思明'),
    ('35', '3503', '350302', '福建', '莆田', '城厢'),
    -- 江西省
    ('36', '3601', '360102', '江西', '南昌', '东湖'),
    ('36', '3602', '360202', '江西', '景德镇', '珠山'),
    ('36', '3603', '360302', '江西', '萍乡', '安源'),
    -- 山东省
    ('37', '3701', '370102', '山东', '济南', '历下'),
    ('37', '3702', '370202', '山东', '青岛', '市南'),
    ('37', '3703', '370302', '山东', '淄博', '淄川'),
    -- 河南省
    ('41', '4101', '410102', '河南', '郑州', '中原'),
    ('41', '4102', '410202', '河南', '开封', '龙亭'),
    ('41', '4103', '410302', '河南', '洛阳', '老城'),
    -- 湖北省
    ('42', '4201', '420102', '湖北', '武汉', '江岸'),
    ('42', '4202', '420202', '湖北', '黄石', '黄石港'),
    ('42', '4203', '420302', '湖北', '十堰', '茅箭'),
    -- 湖南省
    ('43', '4301', '430102', '湖南', '长沙', '芙蓉'),
    ('43', '4302', '430202', '湖南', '株洲', '荷塘'),
    ('43', '4303', '430302', '湖南', '湘潭', '雨湖'),
    -- 广东省
    ('44', '4401', '440106', '广东', '广州', '天河'),
    ('44', '4403', '440301', '广东', '深圳', '福田'),
    ('44', '4404', '440402', '广东', '珠海', '香洲'),
    -- 广西壮族自治区
    ('45', '4501', '450102', '广西', '南宁', '兴宁'),
    ('45', '4502', '450202', '广西', '柳州', '城中'),
    ('45', '4503', '450302', '广西', '桂林', '秀峰'),
    -- 海南省
    ('46', '4601', '460105', '海南', '海口', '秀英'),
    ('46', '4602', '460200', '海南', '三亚', '三亚'),
    ('46', '4603', '460300', '海南', '三沙', '三沙'),
    -- 重庆市
    ('50', '5001', '500101', '重庆', '重庆', '万州区'),
    ('50', '5001', '500103', '重庆', '重庆', '渝中区'),
    ('50', '5001', '500112', '重庆', '重庆', '渝北区'),
    -- 四川省
    ('51', '5101', '510104', '四川', '成都', '锦江'),
    ('51', '5103', '510302', '四川', '自贡', '自流井'),
    ('51', '5104', '510402', '四川', '攀枝花', '东区'),
    -- 贵州省
    ('52', '5201', '520102', '贵州', '贵阳', '南明'),
    ('52', '5202', '520201', '贵州', '六盘水', '钟山区'),
    ('52', '5203', '520302', '贵州', '遵义', '红花岗'),
    -- 云南省
    ('53', '5301', '530102', '云南', '昆明', '五华'),
    ('53', '5303', '530302', '云南', '曲靖', '麒麟'),
    ('53', '5304', '530402', '云南', '玉溪', '红塔'),
    -- 西藏自治区
    ('54', '5401', '540102', '西藏', '拉萨', '城关'),
    ('54', '5402', '540201', '西藏', '日喀则', '桑珠孜区'),
    ('54', '5403', '540301', '西藏', '昌都', '卡若区'),
    -- 陕西省
    ('61', '6101', '610102', '陕西', '西安', '新城区'),
    ('61', '6102', '610202', '陕西', '铜川', '王益区'),
    ('61', '6103', '610302', '陕西', '宝鸡', '渭滨区'),
    -- 甘肃省
    ('62', '6201', '620102', '甘肃', '兰州', '城关'),
    ('62', '6202', '620203', '甘肃', '嘉峪关', '嘉峪关'),
    ('62', '6203', '620302', '甘肃', '金昌', '金川区'),
    -- 青海省
    ('63', '6301', '630102', '青海', '西宁', '城东'),
    ('63', '6302', '630202', '青海', '海东', '乐都'),
    ('63', '6322', '632201', '青海', '海北藏族自治州', '海晏'),
    -- 宁夏回族自治区
    ('64', '6401', '640104', '宁夏', '银川', '兴庆'),
    ('64', '6402', '640202', '宁夏', '石嘴山', '大武口'),
    ('64', '6403', '640302', '宁夏', '吴忠', '利通'),
    -- 新疆维吾尔自治区
    ('65', '6501', '650102', '新疆', '乌鲁木齐', '天山区'),
    ('65', '6502', '650202', '新疆', '克拉玛依', '独山子区'),
    ('65', '6503', '650302', '新疆', '吐鲁番', '高昌区'),
    -- 香港特别行政区
    ('81', '8100', '810000', '香港', '香港', '香港'),
    -- 澳门特别行政区
    ('82', '8200', '820000', '澳门', '澳门', '澳门'),
    -- 台湾省（暂列部分，实际情况较为复杂）
    ('71', '7101', '710100', '台湾', '台北', '台北'),
    ('71', '7102', '710200', '台湾', '高雄', '高雄');


    -- 随机选择一个地区
    DECLARE @AreaCode CHAR(6);
    DECLARE @RandomRegionID INT = CAST(RAND() * (SELECT COUNT(*) FROM #tb_region) AS INT) + 1;

    -- 获取出生地信息
    DECLARE @BirthProvinceCode NVARCHAR(6), @BirthCityCode NVARCHAR(6), @BirthCountyCode NVARCHAR(6);
    DECLARE @BirthProvince NVARCHAR(50), @BirthCity NVARCHAR(50), @BirthCounty NVARCHAR(50);
    SELECT
        @provinceKey = provinceKey,
        @cityKey = cityKey,
        @countyKey = countyKey,
        @province = province,
        @city = city,
        @county = county
    FROM #tb_region WHERE ID = @RandomRegionID;

    -- 赋值输出参数


END
