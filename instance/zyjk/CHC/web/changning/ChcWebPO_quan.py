# coding=utf-8
# >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Author :John
# Created on : 2023-7-25
# Description:
# https://chromedriver.storage.googleapis.com/index.html
# >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

from PO.WebPO import *
# Web_PO = WebPO("chrome")
# Web_PO = WebPO("noChrome")

from PO.CaptchaPO import *
Captcha_PO = CaptchaPO()

from PO.Base64PO import *
Base64_PO = Base64PO()

from PO.FilePO import *
File_PO = FilePO()

from bs4 import BeautifulSoup

from PO.HttpPO import *
Http_PO = HttpPO()
# import ddddocr

class ChcWebPO_quan():

    # def __init__(self):
    #
    #     from ConfigparserPO import *
    #     Configparser_PO = ConfigparserPO('config.ini')
    #
    #     self.varUrl = Configparser_PO.HTTP("url")



    def clsApp(self, varApp):

        '''
        关闭应用程序
        :param varApp:
        :return:
         # clsApp("chrome.exe")
        '''

        l_pid = []
        pids = psutil.pids()
        for pid in pids:
            p = psutil.Process(pid)
            if p.name() == varApp:
                l_pid.append(pid)
        for i in range(len(l_pid)):
            p = psutil.Process(l_pid[i])
            p.terminate()

    def login(self, varUrl, varUser, varPass, varDoc, d_2):
        # 登录
        self.Web_PO = WebPO("chrome")
        # self.Web_PO.set_window_size(1366,768)  # 按分辨率1366*768打开
        # self.Web_PO.maximize_window()  # 全屏
        # self.Web_PO.openURL(varURL)
        self.Web_PO.openURL(varUrl)
        self.Web_PO.setTextByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[1]/div/div/div/input", varUser)
        self.Web_PO.setTextByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[2]/div/div/div/input", varPass)
        # self.Web_PO.setTextByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[3]/div/div/div[1]/input", "1")

        for i in range(10):
            dataURI = self.Web_PO.getAttrValueByX(u"//img[@class='login-code-img']", "src")  # getValueByAttr
            imgFile = Base64_PO.base64ToImg(dataURI)
            captcha = Captcha_PO.getCaptchaByDdddOcr(imgFile)
            File_PO.removeFile('', imgFile)
            # print(captcha)
            self.Web_PO.setTextByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[3]/div/div/div[1]/input", captcha)
            self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[5]/button", 2)

            if self.Web_PO.isEleExistByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[5]/button") == False:
                break

        # self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/form/div[5]/button", 3)

        # 居民健康服务 - 健康评估及干预
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[1]/div[2]/div[1]/div/ul/div[2]/li", 2)
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[1]/div[2]/div[1]/div/ul/div[2]/li/ul/div/a/li", 2)
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[1]/div[2]/div[1]/div/ul/div[2]/li/ul/div[2]/a/li", 2)

        # # # 人群分类
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[3]/div/div/div/div/div/input", 2)
        # # # 老年人
        # self.Web_PO.clkByX("/html/body/div[2]/div[2]/div/div/div[1]/ul/li[4]", 2)
        # #
        # # # 家庭医生
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[4]/div/div/div/div/div/input",2)
        # self.Web_PO.clkByX("/html/body/div[2]/div[3]/div/div/div[1]/ul/li[1]")
        # #
        # # # 本年度上传情况
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[3]/div[1]/div/div/div/div/div/input", 2)
        # self.Web_PO.clkByX("/html/body/div[2]/div[12]/div/div/div[1]/ul/li[1]", 2)
        #
        #
        # # 查询
        # self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[3]/div[2]/div/button")

        # l_1 = []
        # d_1 = {}
        # for k in range(111):
        #     # 前往第几页
        #     self.Web_PO.setTextTabByX2("/html/body/div[1]/div/div[2]/section/div/div/main/div[3]/div/span[3]/div/input", k+1, 2)
        #     l_ = []
        #     for i in range(10):
                a = self.Web_PO.getTextByX("//tbody/tr["+ str(i+1)+ "]/td[8]/div")
        #         l_.append(a)
        #         s = "http://10.207.237.160:8088/login#/SignManage/signAssess/component/basicReport?idCard=" + str(a)
        #         l_1.append(s)
        #     d_1[k+1] = l_
        #     print(k+1, l_)
        # print(d_1)
        #
        # sys.exit(0)

        l_1 = []
#         d_2 = {1: ['310105195703112811', '310108195607312417', '310230195301251466', '310101194104065216', '310102194108264833', '310104195902010889', '310105193207213243',
# '310105193801063217', '310105193805013241', '310105195007080449'], 2: ['320502194801161510', '320502195402253068', '310106194208163226', '310106194608122423', '310105195001203225', '310105195202132830', '310105194011131611', '310103194202151225', '310105194109222829', '310105195107143216'], 3: ['31010619500610402X', '310106194607163215', '310105195601033231', '310105195710161662', '310105195209202053', '310105195112023243', '310105195301123243', '310105195307122823', '310105195308013629', '310105195308221663'], 4: ['310105195310242033', '310105195409183213', '310105195108133239', '310105195011091247', '310105195006093221', '310105194601030028', '310105194609190413', '310105194905102043', '310105194308103224', '310105193803153216'], 5: ['310105195512283220', '310105195508073247', '310105195602222034', '310106195004022813', '310105195806243240', '310105195810011282', '310105195810220818', '310230194802042924', '350102194001050349', '310110194203082026'], 6: ['310105193504272020', '310104195411242861', '310105194602223219', '310228194606115039', '310228194901265021', '310103194602183226', '310105194305022410', '310103194609060018', '310103194711130027', '310105194807281228'], 7: ['310110194210233822', '310105194708113210', '310106195704260425', '61010419540515214X', '370102193407152918', '370102193508232925', '310105195201272014', '310106195512231638', '310106195403291623', '330211194008230017'], 8: ['330211194601270028', '310106195901011639', '320502195205142027', '310107194402111610', '310107194603132442', '310110195407076263', '310228194612305410', '31010519590617326X', '310105195803251616', '310105195501143214'], 9: ['310101195003250441', '532301195201060044', '31022119490928242X', '310103195905201633', '310105195408282025', '310105195908143216', '310105195802203217', '310110193705113836', '310108194705231616', '310105194705011614'], 10: ['31010519540902081X', '310105195612241685', '31022719511102044X', '310105194906283210', '31010519570719202X', '310110195201145884', '310103194601312022', '310101193207131226', '320523192910051217', '310105193801222847'], 11: ['310226195505044923', '310106195407221614', '310105195804192101', '520102195409150411', '310109194108286033', '31023019501026147X', '310107195612062444', '310103195610182439', '310107195511281613', '310105194901201634'], 12: ['310105195603191217', '310105193303093210', '310105195409252856', '310107195410090068', '33040219491120002X', '42020319510506378X', '350402195003230010', '652402194312280343', '31010519580417048X', '310221195401140011'], 13: ['320222195202055963', '310105195306081214', '310104195002142042', '320114195701080041', '34010419550513201X', '310226195708084933', '310104195611091623', '310105195503182815', '310107195504185439', '310107194711070437'], 14: ['310230195007041513', '310112194603080516', '310221195507232010', '310102195112242834', '310104194306272810', '310105194803051628', '310111195211191610', '31010619410923122X', '310105194712241645', '310105194901270023'], 15: ['310225194505290242', '310109193412181629', '310105195703303255', '310101192912022821', '310105194412162435', '310105195512262040', '310101194903260034', '310108195802263286', '310102195401044850', '310101192704140014'], 16: ['310105194402030455', '31010519440209044X', '310107193602032410', '352601194302041019', '340702194102131018', '310105195903272414', '310105195611262441', '310226195711264310', '310105195402112412', '310105195502011328'], 17: ['310105195506292411', '310105195305180421', '310105195303081243', '310105195210220435', '310105194806091246', '310105194702133229', '310105195007150443', '310105194503152427', '310104195412173618', '230804195209050522'], 18: ['110105193606136110', '230602195306061545', '310103194807312036', '310103193911272017', '31022219561231003X', '310226195407134749', '320626195212130215', '350402195607110028', '520102195503030424', '610102193504302324'], 19: ['310107195407134701', '310105195604221270', '310105195607192428', '310105195609290814', '310106194408131210', '310105195902110835', '310110195208064665', '310101195109015255', '310102194912164040', '310104195612090497'], 20: ['310104195706132037', '310105195106013241', '310105195108210900', '31010519510821125X', '310105194911012036', '310105194911153226', '310105195006033210', '310105195007051613', '310105194903081218', '31010519521108325X'], 21: ['310105195205193225', '310105195309032063', '310104195603140472', '310105193211220833', '310105194501113221', '310105194308292416', '310105194102153234', '310105194006171627', '310101195608314057', '310103194509122023'], 22: ['310103195109130010', '310110195801242055', '310107195510161222', '310107194609242028', '310105195809292451', '310105195512272417', '310107195311051215', '310222194902010241', '310222194409030214', '310105194204083222'], 23: ['310107194306152842', '310110195311022017', '310221194903232026', '310229194606170026', '310105195605180060', '310105195911022837', '310105194108272429', '310105194209122446', '310101195610080042', '310105195503261636'], 24: ['310105195411253241', '310105194807212062', '310105194912202851', '310104194808274437', '310105195909123225', '230804195004200515', '310105195907193211', '310105195512113272', '310105195709013224', '320102194911201243'], 25: ['310226195601104738', '310110195707061215', '310103194304102846', '310105195210223222', '310105195603273271', '310106194312070417', '310105195901223248', '310105195607283266', '310106193204013226', '310105194201022440'], 26: ['310108194007104011', '310105195701070902', '360422194809060017', '310105195505202859', '310105194701233260', '310105194101160045', '310105194305180830', '120107194803151511', '310102195205242825', '310227194612040436'], 27: ['310107193403171223', '310107194512152018', '310107195111092821', '310110195210280420', '310109194902044058', '310105195604072439', '310105195510090871', '310106195502074034', '310105195805311221', '310106194512131624'], 28: ['310105195507241632', '310105195702250518', '310112194906150518', '31022919590216002X', '310102195202134060', '310101195110260813', '310103195106013222', '310104195604292865', '310104195611062865', '31010419580430252X'], 29: ['31010519530127202X', '310105195110260042', '310105194912143249', '31010419500430042X', '310104195008010411', '310103193404083211', '332621195106038898', '310105195701040420', '310106194108220019', '310105195902232410'], 30: ['31010519520805161X', '310105195002133214', '310104194201014436', '310103192807132829', '310105195605072836', '310222194012130022', '310108195207291610', '310107194505094622', '310105194504182839', '310107195408222025'], 31: ['310221195801212862', '310106195808181617', '31010519460716123X', '310105195503242056', '310105193712022413', '310106195502140812', '310106194512180442', '31010519551225047X', '310105193404293246', '31010819571105012X'], 32: ['310105195311203220', '310105194008242820', '310105194905260826', '31010319561114125X', '360425195209090718', '31010819510627407X', '310105195708022014', '654001194009180319', '310107194808232412', '310105194009272431'], 33: ['310105194212172428', '310108194501084028', '310105195904072051', '310105195710282878', '310105195703192823', '310109195511052418', '310104195312182859', '31010419540609282X', '310105194412133212', '310105195407270815'], 34: ['310105193301121644', '310110193306043228', '310105195109182817', '310105194702110852', '310104195411064444', '310104195406270841', '310105195012251257', '310105195205022813', '310105195311192410', '310105194911123211'], 35: ['310103194306072417', '310108195606184855', '310107195306061638', '310106195207132828', '231027194905195722', '310105193310143220', '360422195211040024', '310104195706090834', '31010519570225202X', '310105195606063210'], 36: ['310105194709303219', '310105195611130457', '33022219501009314X', '310105195510063232', '310104195703162871', '310104195406164424', '310102193511011225', '310105195504180846', '310105195911032023', '310105195610190810'], 37: ['31010819550402405X', '310105195509201626', '310105195702043236', '310112195104080567', '310105195203262821', '310105195212031654', '310104194905161610', '310104194711130437', '310104195512014067', '33020319470723122X'], 38: ['310105194106283220', '310101195504021620', '310106195207012420', '310104194412220846', '310105193411133240', '310106195709042072', '310105195702093233', '310105194109262820', '620104194712280528', '310101194506105217'], 39: ['31010219501020401X', '310104195412054053', '310105195108080480', '620104194005030511', '310105195308212468', '310101195209101628', '310105193908043224', '310105195709101240', '31011519590530091X', '310105195605053221'], 40: ['310105194412013210', '310101195406250016', '310105194108152048', '310112194812010012', '310109195411104903', '310105193909062814', '310105194310172827', '310221194904172010', '310105195008201249', '310105195311211685'], 41: ['31010519541108322X', '310105195306232828', '360102195305076317', '310110193706041213', '310105195608072823', '310105195511281688', '310105195707182059', '310106195402110413', '310105195812243220', '310105195806040478'], 42: ['310105195805173236', '31010519580728321X', '31010519580730085X', '310105195711281260', '310105195907021663', '310105195012282440', '352601194302161029', '350104195008230016', '360102195210274310', '510302194601300517'], 43: ['330411195106265411', '320602195106162538', '310109194907104865', '310107194406125032', '31010619500107284X', '310106193609100416', '310105195106252859', '310105195102153247', '310105195103022425', '310105194710260818'], 44: ['310105194804263235', '310105194506093223', '310105195210173261', '310105195111153222', '310105195310152433', '310105193303173229', '310102194710174849', '310102195008231238', '120107195011051525', '23010319501122094X'], 45: ['310103195010012022', '31010319541014282X', '310104193206140824', '310104195807263239', '310104195807302840', '310104195504042455', '310105193602243223', '310105194301093211', '310105194408032814', '310105193912033213'], 46: ['310105195310151246', '310105195310041629', '310105195401122010', '310105195403073216', '31010519541101323X', '310105195409231633', '310105195502263226', '310105195201072012', '310105195207253236', '310105195308073226'], 47: ['310105195304113219', '310105194802172460', '310105195008253225', '310106193601300413', '310106195604030833', '310105195909223242', '310105195810222012', '310105195808123242', '310105195807263243', '310105195807282882'], 48: ['310105195803253216', '310105195804083220', '310105195802042847', '310105195802143277', '310105195801192878', '310105195708083255', '310105195711250835', '310105195705190848', '310105195706122038', '310105195709221648'], 49: ['310105195709282029', '310105195701273224', '310105195701273259', '310105195510251620', '310105195601022508', '310105195508042504', '310105195510022473', '310105195608132419', '310105195610260452', '310105195605063227'], 50: ['31010519560401321X', '310105195602053269', '310106195812260836', '310107193806111612', '310107195808180055', '310107195410111244', '310109195611093639', '310110195605303236', '310110195503266219', '330203194210051231'], 51: ['330622195309113426', '310221195708262021', '360425195507090724', '360102195509016324', '360403194801151812', '310105195701133256', '310225195701260643', '310105195111010846', '31010519530503044X', '310105194007283268'], 52: ['31010519530505322X', '310105195403100464', '310105193710152417', '340502195309100423', '310102195702180119', '310105195902203214', '310104195611043250', '310105194012212026', '310105193908073212', '310105194202243210'], 53: ['310105194412130812', '31010519450115324X', '310105193701102442', '310105193409233218', '310105193410152415', '310103193412290034', '310101195206231611', '310101194707280046', '310104193510271220', '310104194010042012'], 54: ['310104194111162048', '310104194502280842', '310105195408231228', '310105195410061627', '31010519521026282X', '310105195209133246', '310105195009163213', '310105195104252011', '310105195105271230', '310105194908183221'], 55: ['310105194807262027', '310105194709203218', '310105194903092822', '31010519460902321X', '310105195903023231', '310105195909112411', '310105195904143227', '310105195804223238', '310106195412202071', '310106195009232430'], 56: ['310106195206062426', '310106194612130020', '310106194702150455', '310105195911273214', '310106194502114011', '310105195509073265', '342101195210190418', '532301195302170015', '310112194204250020', '330402194810260015'], 57: ['31022919510319002X', '310110195108273347', '310111194608121253', '310112194905030012', '310109194608130414', '310109194608262425', '310109194807104817', '310108194908093620', '310107194011051614', '310107193604103243'], 58: ['310106195805143308', '310107195012315444', '310107194712252873', '310109195004164837', '310110195208165810', '310106194503142049', '310105194604132820', '310105194601192019', '310105194707270425', '310105194903290845'], 59: ['310105194901060421', '31010519490506282X', '310105194709063219', '310105195003120036', '310105195103233222', '310105195107262020', '310105195010260416', '310105195010262059', '310105195008080416', '310105195101092024'], 60: ['310105195202043213', '310101194303284032', '310101193801171212', '310105194411111636', '310105194007102826', '310105193901103220', '310105194303083228', '310104195001071668', '310105195111293225', '310105195101062466'], 61: ['310105195106192841', '310105195002153223', '310105195003271301', '31010519490225325X', '310105194903063220', '310105194808313236', '310105194702241254', '310222194412180213', '310222194104231816', '310228194901010424'], 62: ['310230194403151488', '530102194908220717', '530102194908240726', '310112194907090537', '310221193505262014', '310112195110240547', '310109194110284424', '310110193802151228', '310108194406132415', '310108195108191681'], 63: ['310106194010313225', '31010619421015162X', '310105194701153228', '310105194602111620', '310105194808043248', '310105195002280812', '310105194907113248', '310105195111283211', '310105195210010841', '310104194412240441'], 64: ['310104194712060039', '310104194709054826', '310104194012280815', '310102195202072832', '31010219430915362X', '31010519421122162X', '310105194410253237', '310105194503212426', '310105194002253211', '310105194202163210'], 65: ['310105193505282415', '31010519351230204X', '310105193511202442', '310105193207093245', '310105193305260449', '310105194402083215', '310101195209015236', '310104193303080413', '31010519520909286X', '310105194905161617'], 66: ['310105194504253211', '310106194403064047', '310106194601121241', '310106194608080438', '360102194707054343', '420104193410149514', '310228194903125428', '310227194406092614', '310107194512102811', '310109194809284014'], 67: ['31011019521208014X', '310110195011240098', '310106194501140410', '310105194510113223', '310105194606052429', '310105194610283246', '310105194703193215', '31010519490503321X', '31010519480401321X', '310105195102163242'], 68: ['310105195012173244', '310105195210033277', '310105195201270828', '31010519521019322X', '310103194701272830', '310101194111250014', '310102194912025235', '310105194303092423', '310105194209152418', '310105193905291214'], 69: ['310105195012173244', '310105193704162416', '310105193708173657', '310105193709293212', '310105193804173227', '310105193805203213', '310105193804053225', '310104195712231234', '310105195303121225', '310105195411063237'], 70: ['310105195501080436', '310105195311061218', '310106195408130888', '310105195903083226', '310105195611302837', '310105195703030410', '310109195704085240', '310106195910072863', '310107195605101628', '310106195904210027'], 71: ['310105195810290015', '310106195608010848', '310103195802031627', '310103195512203267', '310103195801042420', '310101195902161610', '310101195505180818', '310105195805132039', '310105195702120852', '310106195908231642'], 72: ['310106195803050861', '310108195702040843', '310112195311250020', '310112195312090030', '310107195310160815', '310228195411235051', '330104195602181954', '310105195710023219', '310105195507253211', '310105195511133247'], 73: ['310105195603242029', '310105195604233239', '310105195805163222', '310105195806173262', '310101195704121642', '310105195312263225', '310105195402223251', '310105195503120016', '310105195401123240', '310105195306282841'], 74: ['310105195808283211', '310105195809283248', '310105195904123226', '310105195910223266', '310105195911063284', '310105195910263241', '310105195912203218', '310105195601133224', '310105195801253212', '310105195701183229'], 75: ['310105195704130026', '310105195603251697', '310105195911183227', '310105195910243216', '310105195910043222', '310230195709046976', '310106195908313226', '310107195409044750', '310101195501053256', '310102195708041283'], 76: ['310107195808142411', '310105195909042038', '310105195912261637', '310106195610223252', '310105195710073224', '310105195708072038', '310105195702023227', '310105195511192028', '310106195305010410', '310106195402050481'], 77: ['31010519591215206X', '310105195912191237', '310105195911062054', '310105195810243243', '310110195310316267', '310226195311204941', '310222195305100024', '310221195409212016', '310221195501282412', '342101195409010429'], 78: ['31010219570402243X', '310101195306291611', '310104193309250444', '310104195706250519', '310105193610242837', '310105195303092815', '310105195303213218', '310105195304032072', '310105195412141225', '310112195601230060'], 79: ['330104195608071967', '310108195009072804', '310105195807063217', '310106195507160441', '310105195608233279', '310105195703241234', '310104194505093217', '310105195805022833', '310101194903071639', '31010519311222322X'], 80: ['310105195005163240', '310102195602172031', '310105194304050428', '310105195405103220', '310104194809082031', '310105195707172010', '310105195712122210', '310105195508152025', '310105195508181678', '310107194512212447'], 81: ['310103195211211220', '310105193803152838', '310101195404040015', '310105195011111658', '310105195611170459', '310102194309024019', '310105193908272019', '310105195801093212', '310110193905242018', '310109195304020878'], 82: ['310106195304030428', '310105194409270419', '310105195603163240', '310105195311103211', '310105192909290425', '310104195801144810', '310105195703310842', '310105195507181641', '310106195704202823', '310105195209072842'], 83: ['310104195608092051', '310102195705175235', '310110195110096263', '310105195812192849', '310105194410300427', '310105195202242810', '310105195811292450', '310105195805171337', '310106195906253258', '310103195202053216'], 84: ['310104194211212022', '310105195111030812', '310103195309302868', '310101195604180063', '310105195502142811', '310105195210143222', '310110194412085020', '310105195701143278', '310105195707163261', '310105195707312845'], 85: ['310105195703110437', '310105195411180468', '310105195606013264', '310105195801090863', '310105195908162046', '310109195811204065', '36010219461018431X', '310105195711195020', '31010519550123321X', '310105195310062016'], 86: ['310105195305123224', '310102195911274023', '310105195805031641', '31010619570723007X', '310110195807276248', '31010519421007121X', '310107195807200827', '310106194510150426', '310106195705042446', '310105195705123215'], 87: ['310105193210062423', '310105195310202074', '310105195501113234', '31010519500226162X', '310104194910316832', '310104195112160815', '310105195510232913', '310106193711090445', '310105195712133251', '310105195707020447'], 88: ['310105195911302038', '310101195702051214', '310105195208132823', '32021119570914101X', '310105195208303215', '310104195412120815', '310105195408033213', '310105194610243228', '31010419550723361X', '310105195611201251'], 89: ['310105195701212499', '310105195510091727', '310105194908020473', '310105195307280426', '310105195410082460', '310105195207272445', '310105195210162095', '310105195702162526', '320102195108071210', '31023019550910625X'], 90: ['310108195912190882', '310105195610252815', '310105195501061622', '310105195602143221', '310107195609194622', '31010719561203163X', '310105195808113239', '310105195406283251', '31010519291202323X', '310105194402173229'], 91: ['310103195801232021', '31010519540130325X', '310105195803200843', '310106195701201219', '310105195710303288', '310110195711070851', '310105195703271644', '310106195506242816', '310105195907151660', '310105195412102824'], 92: ['310105195202102826', '230103195005300935', '310104195910171244', '310104195708141279', '31010419580501321X', '310105195202053219', '310105195112282827', '310105195504213214', '310105195407281266', '310105194912131221'], 93: ['310105195101242029', '31010519471218242X', '310105193705040840', '310106195306064082', '310105195712011238', '310105195801111628', '310105195512122814', '310105195601062817', '310105195601132088', '310112195502131526'], 94: ['310109195706303627', '310109195703080085', '310105195507202465', '310105195705310037', '310107195311072032', '310103194411063221', '310105194612153218', '310105195012183223', '310105195204140439', '310105195305113237'], 95: ['310104194711090412', '310105195608223222', '310105195609123215', '310105194803083216', '310105194809092869', '310106193802201614', '310105195911092819', '310105195805261260', '310107195712041640', '330219195404020447'], 96: ['310105194410043213', '310105195803103250', '310105195910292894', '310106194610281220', '310105195509201650', '310105195801132488', '350403194501120019', '310109195009083622', '310104195409134431', '310105195106232831'], 97: ['310105195212283229', '310101194806201649', '510229195301160558', '610103195908282433', '310109195107144812', '310107194804051235', '31010519441111284X', '310105194202022813', '340502195305180411', '310110195312163858'], 98: ['310105194206292415', '310105194405012420', '310105193111270825', '140112195302041129', '310105195208203222', '31010519470805322X', '310103194002102015', '31011019490405583X', '310107195501170821', '320625195404267922'], 99: ['310112195912190545', '310106195301181634', '310106195501031622', '310106194104073226', '310104193503132855', '310105194708032410', '310105194705112423', '310107193710052830', '310221193606210010', '310105195305163218'], 100: ['310105195303063213', '310105195503303242', '310105195001113246', '310107194310104616', '310105195905283213', '310105194708093221', '31010519451221321X', '652823194502103026', '310108194507271027', '31010519500509322X'], 101: ['310104195401232045', '310105195109283239', '310105195611213228', '310105195512163229', '650300194811184620', '310105194601263227', '310105195210293220', '31010219460808242X', '310105195301153231', '310105195312133252'], 102: ['231027194810175710', '310105193511183229', '310105194609211229', '310104194302021643', '310105195710063237', '310104194506302842', '310105195406203215', '310105195401203224', '310105195411252425', '310105195309153236'], 103: ['310105195304063215', '310105195307213223', '310105194912172445', '310105195511053220', '310105195508243269', '310105195603213228', '31010619560622202X', '31010619540104205X', '310110195601035465', '310107195304150434'], 104: ['310105195611273212', '310105195705033228', '310105195702123252', '31010519570704326X', '310105195603301623', '310105195510213229', '310105195808132819', '310105195302023236', '310105195507033227', '310105194308112825'], 105: ['310105192906223243', '310104194504183229', '310105194906241221', '310105195007123226', '310105194701223230', '310105195609113260', '310221194510110415', '310112193703080017', '310109194312194830', '31010719531106506X'], 106: ['310105193510122037', '310105193510252026', '31010519321209041X', '310102193109264435', '310103193811251219', '310105194610080828', '310105195005283226', '310105195404093219', '310229195707160024', '310105195806153210'], 107: ['310105195003213224', '310101195008061244', '310105193606201645', '310105193512093217', '310105193409212046', '310105193804153226', '310105194410043221', '310101194705291219', '310105194908093218', '310105195108063226'], 108: ['310105194603223245', '310105194712243261', '310105195405012820', '310105195808073222', '310105195802052500', '310105195805113225', '310105195907123221', '310105195901053242', '310105195609233238', '310108194610062813'], 109: ['310109195004214021', '310110194708193258', '310105195811253232', '31010519490804044X', '31010519500203323X', '310101194511153678', '310105194503261658', '310105194107312425', '310105194205262425', '310105193902243225'], 110: ['310105194504142423', '310105194404193223', '310105193703113225', '31010419441009003X', '310104194605060068', '310105194907313231', '310105194711183244', '310105194508163213', '31010519531003201X', '310105195209043232'],111: ['310106194105031626', '310105195911093221', '310105195601273227', '310105195709193245', '310105195006163218', '310105193710173234', '310105193907073229', '310105194012213221', '310105194912122827', '310105195208023248']}

#         d_2 ={1: ['310105195703112811', '310108195607312417', '310230195301251466', '310101194104065216', '310102194108264833', '310104195902010889', '310105193207213243',
# '310105193801063217', '310105193805013241', '310105195007080449'], 2: ['320502194801161510', '320502195402253068', '310106194208163226', '310106194608122423',
#  '310105195001203225', '310105195202132830', '310105194011131611', '310103194202151225', '310105194109222829', '310105195107143216']}
        for k,v in d_2.items():
            l_1 = []
            for i in v:
                s = "http://10.207.237.160:8088/login#/SignManage/signAssess/component/basicReport?idCard=" + str(i)
                l_1.append(s)

            print(l_1)

            for i in range(len(l_1)):
                self.Web_PO.opnLabel(l_1[i])
                self.Web_PO.swhLabel(i + 1)
                sleep(2)
                l_ = self.Web_PO.getTextByXs("//span")
                sleep(1)
                for j in l_:
                    if j == "待上传市级平台":
                        # self.Web_PO.cls()
                        ...

                    elif j == "上传报告":
                        # 上次报告
                        self.Web_PO.scrollViewByX("/html/body/div[1]/div/div[2]/section/div/div/section/footer/button[3]")
                        self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/section/footer/button[3]", 1)
                        if self.Web_PO.isEleExistByX("/html/body/div[5]/div/div/div[3]/button[2]"):
                            self.Web_PO.clkByX("/html/body/div[5]/div/div/div[3]/button[2]", 1)
                        elif self.Web_PO.isEleExistByX("/html/body/div[3]/div/div/div[3]/button[2]"):
                            self.Web_PO.clkByX("/html/body/div[3]/div/div/div[3]/button[2]", 1)
            sleep(30)
            print("已完成", varDoc, "第", k, "页")

            for i in range(10):
                self.Web_PO.swhLabel(1)
                self.Web_PO.cls()
            self.Web_PO.swhLabel(0)





        # 点击第一条
        # for k in range(500):
        #     # 前往第几页
        #     self.Web_PO.setTextByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[3]/div/span[3]/div/input", k+1, 2)
        #     for i in range(5,10):
        #         # # 查询
        #         self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[3]/div[2]/div/button")
        #         # 点击第N行
        #         # /html/body/div[1]/div/div[2]/section/div/div/main/div[2]/div/div[1]/div[3]/div/div[1]/div/table/tbody/tr[1]/td[12]/div/button
        #         self.Web_PO.scrollViewByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[2]/div/div[1]/div[3]/div/div[1]/div/table/tbody/tr[" + str(i+1) + "]/td[12]/div/button", 1)
        #         self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[2]/div/div[1]/div[3]/div/div[1]/div/table/tbody/tr[" + str(i+1) + "]/td[12]/div/button", 4)
        #         l_ = self.Web_PO.getTextByXs("//span")
        #         for j in l_:
        #             if j == "待上传市级平台":
        #                 # 返回
        #                 if self.Web_PO.isEleExistByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/span") == True:
        #                     self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/span", 2)
        #                     break
        #
        #             if j == "上传报告":
        #                 # 上次报告
        #                 self.Web_PO.scrollViewByX("/html/body/div[1]/div/div[2]/section/div/div/section/footer/button[3]")
        #                 self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/section/footer/button[3]", 2)
        #                 if self.Web_PO.isEleExistByX("/html/body/div[5]/div/div/div[3]/button[2]"):
        #                     self.Web_PO.clkByX("/html/body/div[5]/div/div/div[3]/button[2]", 1)
        #                 elif self.Web_PO.isEleExistByX("/html/body/div[3]/div/div/div[3]/button[2]"):
        #                     self.Web_PO.clkByX("/html/body/div[3]/div/div/div[3]/button[2]", 1)
        #
        #                 # 返回
        #                 sleep(20)
        #                 # /html/body/div[1]/div/div[2]/div[1]/div[2]/span
        #
        #                 if self.Web_PO.isEleExistByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/span") == True:
        #                     self.Web_PO.scrollViewByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/span", 1)
        #                     self.Web_PO.clkByX("/html/body/div[1]/div/div[2]/div[1]/div[2]/span", 2)
        #                     # /html/body/div[1]/div/div[2]/div[1]/div[2]/span
        #                 break

        # /html/body/div[1]/div/div[2]/section/div/div/main/div[2]/div/div[1]/div[3]/div/div[1]/div/table/tbody/tr[1]/td[12]/div/button
        # /html/body/div[1]/div/div[2]/section/div/div/main/div[2]/div/div[1]/div[3]/div/div[1]/div/table/tbody/tr[2]/td[12]/div/button



    def clkMenu(self, html_source, varMenuName, t=2):
        """点击菜单"""
        # 1, 获取html_source
        soup = BeautifulSoup(html_source, 'html.parser')

        # 2, 获取菜单和链接，所有a标签的href属性
        d_menuUrl = {}
        for link in soup.find_all('a'):
            key = str(soup.find("a", {'href': link.get('href')}).find_all('span'))
            if key != "[]" and '<span class="menu-title" title="' in key:
                s = BeautifulSoup(key, 'lxml')
                tag = s.span
                # print(tag.get_text())
                d_menuUrl[tag.get_text()] = link.get('href')
        # print(d_menuUrl)  # {'首页': '#/index', '健康服务': '#/SignManage/service', '健康评估及干预': '#/SignManage/signAssess', '慢病管理': '#/SignManage/chronic', '老年人体检': '#/SignManage/snrExam', '重点人群': '#/SignManage/keyPopulation', '居民登记': '#/OpManage/register', '健康评估': '#/OpManage/assess', '机构维护': '#/UserManage/org', '用户维护': '#/UserManage/user', '角色维护': '#/UserManage/role', '接口管理': '#/UserManage/interface', '批量评估': '#/UserManage/MassAppraisal', '错误日志': '#/UserManage/errorLog', '常住人口': '#/Community/permanent', '家医团队维护': '#/Community/team', '家医助手': '#/Community/assistant', '干预规则配置': '#/Community/interveneRule', '停止评估名单': '#/Community/stopList', '社区用户维护': '#/Community/communityUser', '评估建议': '#/Community/SuggestionTemplate', '定时任务': '#/monitor/index', '社区健康评估': '#/dataStatistics/communityHealth', '全区健康评估': '#/dataStatistics/allHealth'}

        for k,v in d_menuUrl.items():
            if k == varMenuName:
                # print("http://192.168.0.243:8010/" + d_menuUrl[varMenuName])
                Web_PO.opn(self.varUrl + d_menuUrl[varMenuName])
        sleep(t)

    def getTechnicalTarget(self):
        """首页，获取首页指标"""
        l1 = Web_PO.getTextListByX("//div[@class='headerdiv']")
        l2 = Web_PO.getTextListByX("//div[@class='box_center']")

        # 签约居民总数（人）
        qyjmzs = l1[0].split("\n")
        print(qyjmzs)

        # 重点人群
        zdrq = l1[1].split("\n")
        print(zdrq)

        # 疾病风险人群\普通人群
        jbfx = l1[2].split("\n")
        print(jbfx)

        # 健康档案完善
        jkdaws = l2[0].split("\n")
        print(jkdaws)

        # 慢病随访
        mbsf = l2[1].split("\n")
        print(mbsf)

        # 老年人体检
        lnrtj = l2[2].split("\n")
        print(lnrtj)

        # 65岁以上重点人群管理
        zdrqgl = l2[3].split("\n")
        print(zdrqgl)

    def _dropDownList(self, varValue, varXpath):
        """下拉框定义"""
        Web_PO.clsReadonlyByX(varXpath)
        Web_PO.setTextByX(varXpath, varValue)

    def healthEvaluateIntervene_search(self, d):
        """健康评估及干预 - 查询"""
        #({'姓名': '儿童', '身份证': '310101', '人群分类': '老年人', '家庭医生': '测试', '签约日期范围start': '2024-05-05',
                           # '签约日期范围end': '2024-05-07', '年度评估状态': '未评估', '管理人群': '高血压', '最近一次评估日期start': '2024-05-05',
                           # '最近一次评估日期end': '2024-05-07', '最近一次确认日期start': '2024-05-05', '最近一次确认日期end': '2024-05-07'})

        if '姓名' in d: Web_PO.setTextByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[1]/div/div/div/input", d['姓名'])
        if '身份证' in d: Web_PO.setTextByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[2]/div/div/div/input", d['身份证'])
        if '人群分类' in d: self._dropDownList(d['人群分类'], "/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[3]/div/div/div/div/div/input")
        if '家庭医生' in d: self._dropDownList(d['家庭医生'], "/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[4]/div/div/div/div/div/input")
        if '签约日期范围start' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[5]/div/div/div[1]/input", d['签约日期范围start'])
        if '签约日期范围end' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[1]/div[5]/div/div/div[2]/input", d['签约日期范围end'])
        if '年度评估状态' in d: self._dropDownList(d['年度评估状态'], "/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[1]/div/div/div/div/div/input")
        if '管理人群' in d: self._dropDownList(d['管理人群'], "/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[2]/div/div/div/div/div[2]/input")
        if '最近一次评估日期start' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[3]/div/div/div[1]/input", d['最近一次评估日期start'])
        if '最近一次评估日期end' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[3]/div/div/div[2]/input", d['最近一次评估日期end'])
        if '最近一次确认日期start' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[4]/div/div/div[1]/input", d['最近一次确认日期start'])
        if '最近一次确认日期end' in d: Web_PO.setTextEnterByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[2]/div[4]/div/div/div[2]/input", d['最近一次确认日期end'])

        # 查询
        Web_PO.clkByX("/html/body/div[1]/div/div[2]/section/div/div/main/div[1]/form/div[3]/div/div/button")
    def edtBasicInfo(self, idCard):
        # 2，通过身份证打开用户页
        Web_PO.opnLabel('http://172.16.209.10:9071/cdc/a/doctor/archive/detail?personcard=' + str(idCard))
        Web_PO.setTextById('one2', 1)  # 基本信息

        # todo 基本信息

        # {'姓名': '魏梅娣', '民族': '苗族', '文化程度': '小学教育', '职业': '军人', '就业状态': '其他',
        #  '婚姻状况': '离婚', '工作单位': '北京科美有限公司', '手机号': '13011234567', '固定电话': '58776543', '联系人姓名': '魏梅名', '联系人电话': '13356789098',
        #  '血型': 'B型', 'Rh血型': '不详', '医疗费用支付方式': '全自费'}

        # # 姓名
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[1]/td[2]/span/span/input', '魏梅娣')
        # 民族
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[3]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[3]/td[2]/span/span/input', '苗族')
        # 文化程度
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[3]/td[4]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[3]/td[4]/span/span/input', '小学教育')
        # 职业
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[4]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[4]/td[2]/span/span/input', '军人')
        # 就业状态
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[5]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[5]/td[2]/span/span/input', '其他')
        # 婚姻状况
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[7]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[7]/td[2]/span/span/input', '离婚')
        # 工作单位
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[7]/td[4]/span/span/input', '北京科美有限公司')
        # 手机号
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[8]/td[2]/span/span/input', '13011234567')
        # 固定电话
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[9]/td[2]/span/span/input', '58776543')
        # 联系人姓名
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[10]/td[2]/span/span/input', '魏梅名')
        # 联系人电话
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[10]/td[4]/span/span/input', '13356789098')
        # 血型
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[11]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[11]/td[2]/span/span/input', 'B型')
        # Rh血型
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[11]/td[4]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[11]/td[4]/span/span/input', '不详')
        # 医疗费用支付方式
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[12]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[12]/td[2]/span/span/input', '全自费')
 
        # 残疾情况
        varStatus = True
        var = {"视力残疾": "2222", "语言残疾": "3333", "其他残疾": "121212"}
        currStatus = Web_PO.isSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[1]/span/input')  # 无残疾是否勾选
        # cj1,默认无残疾，要求无残疾，不操作
        if currStatus == True:
            if varStatus == True:
                ...
            else:
                # cj2,默认无残疾，要求视力残疾，翻勾选无，勾选视力残疾。
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[1]', 1)  # 无
                # 遍历勾选
                for k, v in var.items():
                    if k == '视力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[2]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '听力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[3]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '语言残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[4]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '肢体残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[5]/span/input',1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '智力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[6]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '精神残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[7]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '其他残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[3]', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[4]/span/span/input', v)  # 残疾说明
        if currStatus == False:
            # cj3,默认视力残疾，要求无残疾，勾选无残疾。
            if varStatus == False:
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[1]', 1)  # 无
            # cj4，默认视力残疾，要求精神残疾，操作取消所有勾选，勾选精神残疾。
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[2]/span/input')  # 视力残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[3]/span/input')  # 听力残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[4]/span/input')  # 语言残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[5]/span/input')  # 肢体残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[1]/span/input')  # 智力残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[2]/span/input')  # 精神残疾
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[3]/span/input')  # 其他残疾

                # 遍历勾选
                for k, v in var.items():
                    if k == '视力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[2]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '听力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[3]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '语言残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[4]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '肢体残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[5]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '智力残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[6]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '精神残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[1]/td[7]/span/input', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[4]/span/span/input', v)  # 残疾证号码
                    if k == '其他残疾':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[3]', 1)
                        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[1]/table/tbody/tr[13]/td[2]/table/tbody/tr[2]/td[4]/span/span/input', v)  # 残疾说明

        # todo 户籍地址
        # {'省（自治区、直辖市）': '北京市', '市（地区/州）': '市辖区', '县（区）': '丰台区', '街道（镇）': '南苑街道办事处', '居委（村）': '机场社区居委会', '详细地址': '洪都拉斯100号'}
        var = ['北京市', '市辖区', '丰台区', '南苑街道办事处', '机场社区居委会', '洪都拉斯100号']
        # 省（自治区、直辖市）
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[1]/td[2]/span/span/input', var[0])
        # 市（地区/州）
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[1]/td[4]/span/span/input', var[1])
        # 县（区）
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[1]/td[6]/span/span/input', var[2])
        # 街道（镇）
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[2]/td[2]/span/span/input', var[3])
        # 居委（村）
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[2]/td[4]/span/span/input', var[4])
        # 详细地址
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[1]/tr[3]/td[2]/span/span/input', var[5])

        # todo 居住地址
        # 同户籍地址
        # {'省（自治区、直辖市）': '北京市', '市（地区/州）': '市辖区', '县（区）': '丰台区', '街道（镇）': '南苑街道办事处', '居委（村）': '机场社区居委会', '详细地址': '洪都拉斯100号'}

        varStatus = True
        var = ['北京市', '市辖区', '丰台区', '南苑街道办事处', '机场社区居委会', '洪都拉斯100号']
        currStatus = Web_PO.isSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/thead[3]/tr/th/span/input')
        if currStatus == True:
            # cj1, 默认是勾选同户籍地址，要求也是勾选同户籍地址，不操作
            if varStatus == True:
                ...
            else:
                # cj2，默认是勾选同户籍地址，要求不勾选同户籍地址，操作反勾选同户籍地址，同时填入一下信息
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/thead[3]/tr/th/span/input', 1)  # 不勾选同户籍地址
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[2]/span/span/input', var[0])  # 省（自治区、直辖市）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[4]/span/span/input', var[1])  # 市（地区/州）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[6]/span/span/input', var[2])  # 县（区）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[2]/td[2]/span/span/input', var[3])  # 街道（镇）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[2]/td[4]/span/span/input', var[4])  # 居委（村）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[3]/td[2]/span/span/input', var[5])  # 详细地址
        else:
            # cj3，默认是不勾选同户籍地址，要求勾选同户籍地址
            if varStatus == True:
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/thead[3]/tr/th/span/input', 1)
            else:
                # cj4,默认是不勾选同户籍地址，要求更新以下信息。
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[2]/span/span/input', var[0])   # 省（自治区、直辖市）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[4]/span/span/input', var[1])  # 市（地区/州）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[1]/td[6]/span/span/input', var[2])  # 县（区）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[2]/td[2]/span/span/input', var[3])  # 街道（镇）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[2]/td[4]/span/span/input', var[4])  # 居委（村）
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[2]/tr[3]/td[2]/span/span/input', var[5])  # 详细地址


        # todo 其他信息
        # {'家庭厨房排风设施标识': '烟囱', '家庭燃料类别': '煤', '家庭饮用水类别': '井水', '家庭厕所类别': '马桶', '家庭禽畜栏类别': '室内'}

        # 家庭厨房排风设施标识
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[2]/span/span/input', '烟囱')
        # 家庭燃料类别
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[4]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[4]/span/span/input', '煤')
        # 家庭饮用水类别
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[6]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[1]/td[6]/span/span/input', '井水')
        # 家庭厕所类别
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[2]/td[2]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[2]/td[2]/span/span/input',' 马桶')
        # 家庭禽畜栏类别
        Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[2]/td[4]/span/span/input')
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[2]/td[4]/span/span/input', '室内')

        # # 药物过敏史
        varStatus = '有'
        var = ['头孢类抗生素', '酒精', {"其他药物过敏原": '3333'}]
        # 判断默认勾选的是无还是有
        currStatus = Web_PO.getAttrValueByX(u'//div[@id="signAllergy"]/table/tbody/tr/td/div/div[1]', '类与实例')
        if currStatus == "mini-radiobuttonlist-item":
            currStatus = '无'
        else:
            currStatus = '有'
        if currStatus == '无':
            # cj1,默认无，要求无，不操作
            if varStatus == '无':
                ...
            else:
                # cj2，默认无，要求有，勾选有，勾选酒精
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[1]/div/table/tbody/tr/td/div[1]/div[1]/input', 1)
                for i in range(len(var)):
                    if var[i] == '青霉素抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[1]/input', 1)
                    if var[i] == '磺胺类抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[2]/input', 1)
                    if var[i] == '头孢类抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[3]/input', 1)
                    if var[i] == '含碘药品':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[1]/input', 1)
                    if var[i] == '酒精':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[2]/input', 1)
                    if var[i] =='镇静麻醉剂':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[3]/input', 1)
                    if isinstance(var[i], dict) == True:
                        for k1, v1 in var[i].items():
                            if k1 == '其他药物过敏原':
                                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[4]/input', 1)
                                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[5]/span/input', v1)
        else:
            # cj3,默认有，要求无，勾选无
            if varStatus == '无':
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[1]/div/table/tbody/tr/td/div[1]/div[2]/input', 1)
            else:
                # cj4，默认有，取消所有复选框，勾选酒精
                for i in range(1, 3):
                    Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[' + str(i) + ']/input')
                for i in range(1, 4):
                    Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[' + str(i) + ']/input')
                for i in range(len(var)):
                    if var[i] == '青霉素抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[1]/input', 1)
                    if var[i] == '磺胺类抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[2]/input', 1)
                    if var[i] == '头孢类抗生素':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[1]/span[3]/input', 1)
                    if var[i] == '含碘药品':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[1]/input', 1)
                    if var[i] == '酒精':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[2]/input', 1)
                    if var[i] =='镇静麻醉剂':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[3]/input', 1)
                    if isinstance(var[i], dict) == True:
                        for k1, v1 in var[i].items():
                            if k1 == '其他药物过敏原':
                                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[4]/input', 1)
                                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[3]/td[2]/table/tbody/tr/td[2]/div[2]/span[5]/span/input', v1)


        # 环境危险因素暴露类别
        varStatus = False
        var = ['毒物', '化学品', {'其他': "11111"}]

        # 判断是否勾选了无
        currStatus = Web_PO.isSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[1]/span/input')
        if currStatus == True:
            # cj1,默认勾选无，要求勾选无，不操作。
            if varStatus == True:
                ...
            # cj2，默认勾选无，要求勾选其他，操作取消无勾选，勾选其他
            elif varStatus == False:
                # 取消无勾选
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[1]/span/input', 1)
                for i in range(len(var)):
                    if var[i] == '化学品':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[2]/span/input', 1)
                    if var[i] == '毒物':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[3]/span/input', 1)
                    if var[i] == '射线':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[4]/span/input', 1)
                    if var[i] == '不详':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[1]/span/input', 1)
                    if isinstance(var[i], dict) == True:
                        for k1, v1 in var[i].items():
                            if k1 == '其他':
                                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[2]/span/input', 1)
                                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[3]/span/span/input', v1)
        else:
            # cj3，默认不勾选无，要求勾选无，直接勾选无。
            if varStatus == True:
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[1]/span/input', 1)
            else:
                # cj4，默认不勾选无，要求勾选化学，操作取消所有勾选，勾选化学。
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[2]/span/input')  # 化学品
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[3]/span/input')  # 毒物
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[4]/span/input')  # 射线
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[1]/span/input')  # 不详
                Web_PO.clrSelected('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[2]/span/input')  # 其他
                for i in range(len(var)):
                    if var[i] == '化学品':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[2]/span/input', 1)
                    if var[i] == '毒物':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[3]/span/input', 1)
                    if var[i] == '射线':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[1]/td[4]/span/input', 1)
                    if var[i] == '不详':
                        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[1]/span/input', 1)
                    if isinstance(var[i], dict) == True:
                        for k1, v1 in var[i].items():
                            if k1 == '其他':
                                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[2]/span/input', 1)
                                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[2]/table/tbody[3]/tr[4]/td[2]/table/tbody/tr[2]/td[3]/span/span/input', v1)



        # todo 疾病信息
        # 疾病史
        # 风险1：不知道当前用户有多少疾病史，默认最多5个，全部关闭。???
        varQty = 5
        var = {'脑卒中': '2010-12-01', '其他法定传染病': ['baidu', '2020-12-10'], '高血压': '2010-12-02', '其他': ['12121', '2020-12-12']}
        for i in range(varQty):
            Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[2]/td[3]/span[1]/span/input')
            tmp = Web_PO.getTextByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[2]/td[3]/span[1]/span/input')
            print(tmp)
            if tmp != "无":
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[2]/td[2]/input', 1)  # -
                Web_PO.clkByX(u"//a[@href='javascript:void(0)']", 2)  # 弹框确认
        x = 1
        for k, v in var.items():
            x = x + 1
            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[1]/td[2]/input[1]')  # +
            if k == '其他' or k == '其他法定传染病':
                Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[3]/span[1]/span/input')
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[3]/span[1]/span/input', k)
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[3]/span[2]/span/input', v[0])
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[4]/span/span/input', v[1])
            else:
                Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[3]/span[1]/span/input')
                Web_PO.setTextEnterByX('//html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[3]/span[1]/span/input', k)
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[1]/tbody/tr[' + str(x) + ']/td[4]/span/span/input', v)


        # 手术史
        varStatus = '有'
        var = {'手术1': '2010-12-01', '手术2': '2010-12-02'}
        # cj1，要求无，点击无，弹出框确认
        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[2]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[2]/input', 1)  # 无
        Web_PO.clkByX(u"//a[@href='javascript:void(0)']", 1)  # 确定删除记录
        # cj2,默认无，要求有，点击有，输入内容
        # cj3，默认有，要求有，修改原有数据
        if varStatus == '有':
            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[2]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[1]/input', 1)  # 有
            x = 1
            for k, v in var.items():
                x = x + 1
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[2]/tbody/tr/td[2]/input', 1)  # +
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[2]/tbody/tr[' + str(x) + ']/td[3]/span/span/input', k)  # 名称
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[2]/tbody/tr[' + str(x) + ']/td[4]/span/span/input', v)  # 手术日期


        # 外伤史
        varStatus = '有'
        var = {'外伤3': '2020-12-01', '外伤4': '2020-12-02'}
        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[3]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[2]/input', 1)  # 无
        Web_PO.clkByX(u"//a[@href='javascript:void(0)']", 1)  # 确定删除记录
        if varStatus == '有':
            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[3]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[1]/input', 1)  # 有
            x = 1
            for k, v in var.items():
                x = x + 1
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[3]/tbody/tr/td[2]/input', 1)  # +
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[3]/tbody/tr[' + str(x) + ']/td[3]/span/span/input', k)  # 名称
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[3]/tbody/tr[' + str(x) + ']/td[4]/span/span/input', v)  # 发生日期


        # 输血史
        varStatus = '有'
        var = {'输血4': '2020-12-12', '输血5': '2020-12-13'}
        Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[4]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[2]/input', 1)  # 无
        Web_PO.clkByX(u"//a[@href='javascript:void(0)']", 1)  # 确定删除记录
        if varStatus == '有':
            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[4]/tbody/tr/td[2]/div/table/tbody/tr/td/div[1]/div[1]/input',1)  # 有
            x = 1
            for k, v in var.items():
                x = x + 1
                Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[4]/tbody/tr/td[2]/input', 1)  # +
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[4]/tbody/tr[' + str(x) + ']/td[3]/span/span/input', k)  # 数学原因
                Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[4]/tbody/tr[' + str(x) + ']/td[4]/span/span/input', v)  # 输血日期


        # 家族史 {家庭关系：疾病种类}
        var = {"母亲": ['高血压', '糖尿病', {'其他法定传染病':'123'}], "父亲": ['性阻塞性肺疾病', '脑卒中', {'其他': '4444123'}]}
        for k, v in var.items():
            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr/td[2]/input', 1)  # +
            Web_PO.clsReadonlyByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[3]/span/span/input')  # 家庭关系
            Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[3]/span/span/input', k)  # mother
            for i in range(len(v)):
                if v[i] == '高血压':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[2]/input',1) # 高血压
                if v[i] == '糖尿病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[3]/input',1) # 糖尿病
                if v[i] == '冠心病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[4]/input',1) # 冠心病
                if v[i] == '慢性阻塞性肺疾病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[5]/input',1) # 慢性阻塞性肺疾病
                if v[i] == '恶性肿瘤':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[6]/input',1) # 恶性肿瘤
                if v[i] == '脑卒中':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[7]/input',1) # 脑卒中
                if v[i] == '重性精神疾病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[8]/input',1) # 重性精神疾病
                if v[i] == '结核病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[9]/input',1) # 结核病
                if v[i] == '肝炎':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[10]/input',1) # 肝炎
                if v[i] == '先天畸形':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[11]/input',1) # 先天畸形
                if v[i] == '职业病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[12]/input',1) # 职业病
                if v[i] == '肾脏疾病':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[13]/input',1) # 肾脏疾病
                if v[i] == '贫血':
                    Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[14]/input',1) # 贫血
                if isinstance(v[i], dict) == True:
                    for k1, v1 in v[i].items():
                        if k1 == '其他法定传染病':
                            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[15]/input',1)  # 其他法定传染病
                            Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[16]/span/input', v1)
                        if k1 == '其他':
                            Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[17]/input',1)  # 其他
                            Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[5]/tbody/tr[2]/td[4]/span[18]/span/input', v1)


        # 遗传性疾病史
        var = '121212'
        Web_PO.setTextEnterByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[3]/table[6]/tbody/tr/td[2]/span/span/textarea', var)

        # 保存
        # Web_PO.setTextById('button1', 1)

        # 关闭
        # Web_PO.clkByX('/html/body/div[1]/div/div[2]/div[2]/div/div/div[4]/a/input', 1)

